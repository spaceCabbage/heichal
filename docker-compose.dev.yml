version: '3.8'

# Development overrides
cservices:
  django:
    build:
      dockerfile: ../docker/django/Dockerfile.dev
    environment:
      - DJANGO_DEBUG=true
    volumes:
      - ./server:/app
    command: >
      sh -c "python manage.py migrate &&
             python manage.py runserver 0.0.0.0:8000"

  vue:
    build:
      dockerfile: ../docker/vue/Dockerfile.dev
    volumes:
      - ./client:/app
      - /app/node_modules
    command: npm run dev -- --host 0.0.0.0 --port 3000

  # Disable Caddy in development
  caddy:
    profiles:
      - disabled
